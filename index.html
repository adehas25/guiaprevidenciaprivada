<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia e Calculadora de Previdência Privada</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .hero-bg {
            background-color: #003366;
            background-image: linear-gradient(135deg, #003366 0%, #0056b3 100%);
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #D1D5DB;
            border-radius: 0.5rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .form-input:focus {
            outline: none;
            border-color: #0056b3;
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.2);
        }
        .calculate-btn {
            background-color: #0056b3;
            transition: background-color 0.3s;
        }
        .calculate-btn:hover {
            background-color: #003366;
        }
        .result-card {
            background-color: #f0f9ff;
            border-left: 4px solid #0056b3;
        }
        .result-card-vgbl {
            background-color: #f0fff4;
            border-left: 4px solid #10B981;
        }
        .loader {
            width: 16px;
            height: 16px;
            border: 2px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Seção Hero -->
    <header class="hero-bg text-white p-8 md:p-12 text-center">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">Desvende o Futuro da sua Aposentadoria</h1>
            <p class="text-lg md:text-xl text-gray-200">Um guia completo e interativo para você entender a Previdência Privada e tomar as melhores decisões para o seu futuro financeiro.</p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-4 md:p-8">
        
        <!-- Seção Introdutória -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-900 mb-4">Por que a Previdência Privada é Essencial?</h2>
            <p class="text-lg text-gray-600 leading-relaxed">Planejar a aposentadoria é construir a liberdade de viver o futuro com tranquilidade. Em um cenário de mudanças na previdência pública (INSS), ter um plano complementar se torna uma estratégia inteligente. Ele não apenas complementa sua renda, mas também serve como uma poderosa ferramenta de investimento para realizar grandes projetos. O segredo é começar cedo e deixar o tempo e os juros compostos trabalharem a seu favor.</p>
        </section>

        <!-- Seção PGBL vs VGBL -->
        <section class="mb-12 bg-white p-8 rounded-xl shadow-md">
            <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">1ª Escolha: PGBL vs. VGBL</h2>
            <div class="grid md:grid-cols-2 gap-8 items-start">
                <div class="space-y-4">
                    <h3 class="text-2xl font-semibold text-blue-800">PGBL (Plano Gerador de Benefício Livre)</h3>
                    <p class="text-gray-600">Ideal para quem faz a **declaração completa do Imposto de Renda**. Permite deduzir os aportes anuais em até 12% da sua renda bruta tributável, pagando menos imposto hoje. No resgate, o imposto incide sobre o valor **TOTAL** (aportes + rendimentos).</p>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <p class="font-semibold text-blue-700">Perfil Ideal:</p>
                        <ul class="list-disc list-inside text-gray-600 mt-2">
                            <li>Declara o IR no modelo completo.</li>
                            <li>Contribui para o INSS.</li>
                            <li>Busca um benefício fiscal no presente.</li>
                        </ul>
                    </div>
                </div>
                <div class="space-y-4">
                    <h3 class="text-2xl font-semibold text-green-800">VGBL (Vida Gerador de Benefício Livre)</h3>
                    <p class="text-gray-600">Perfeito para quem faz a **declaração simplificada do IR ou é isento**. Não há benefício fiscal nos aportes, mas a grande vantagem está no resgate: o imposto incide **APENAS SOBRE OS RENDIMENTOS**.</p>
                     <div class="bg-green-50 p-4 rounded-lg">
                        <p class="font-semibold text-green-700">Perfil Ideal:</p>
                        <ul class="list-disc list-inside text-gray-600 mt-2">
                            <li>Declara o IR no modelo simplificado ou é isento.</li>
                            <li>Já atingiu o teto de 12% do PGBL.</li>
                            <li>Foca em planejamento sucessório.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Seção Tributação -->
        <section class="mb-12 bg-white p-8 rounded-xl shadow-md">
            <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">2ª Escolha: Regime de Tributação</h2>
            <p class="text-center text-gray-600 mb-6">Graças à legislação atual, você pode fazer essa escolha somente no momento do resgate!</p>
            <div class="grid md:grid-cols-2 gap-8 items-start">
                <div class="space-y-4">
                    <h3 class="text-2xl font-semibold text-gray-800">Tabela Progressiva</h3>
                    <p class="text-gray-600">A alíquota de imposto aumenta conforme o valor do resgate (de 0% a 27,5%), seguindo a mesma lógica do imposto sobre salários. É mais indicada para quem planeja resgates de menor valor ou receber uma renda mensal mais baixa na aposentadoria.</p>
                </div>
                <div class="space-y-4">
                    <h3 class="text-2xl font-semibold text-gray-800">Tabela Regressiva</h3>
                    <p class="text-gray-600">A alíquota de imposto diminui com o tempo. Começa em 35% e pode chegar a apenas **10%** para investimentos mantidos por mais de 10 anos. É a melhor opção para o planejamento de **longo prazo** e resgates de valores maiores.</p>
                </div>
            </div>
        </section>

        <!-- Seção das Calculadoras -->
        <section>
            <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">Simule seu Investimento</h2>
            <div class="grid md:grid-cols-2 gap-8">
                
                <!-- Calculadora PGBL -->
                <div class="bg-white p-6 rounded-xl shadow-lg space-y-4">
                    <h3 class="text-2xl font-semibold text-blue-800">Calculadora PGBL</h3>
                    <div>
                        <label for="pgbl-initial" class="font-medium text-gray-700">Aporte Inicial (R$)</label>
                        <input type="number" id="pgbl-initial" class="form-input mt-1" placeholder="0">
                    </div>
                    <div>
                        <label for="pgbl-monthly" class="font-medium text-gray-700">Aporte Mensal (R$)</label>
                        <input type="number" id="pgbl-monthly" class="form-input mt-1" placeholder="500">
                    </div>
                    <div>
                        <label for="pgbl-years" class="font-medium text-gray-700">Tempo de Investimento (anos)</label>
                        <input type="number" id="pgbl-years" class="form-input mt-1" placeholder="30">
                    </div>
                    <div>
                        <label for="pgbl-rate" class="font-medium text-gray-700">Rentabilidade Anual (%)</label>
                        <input type="number" id="pgbl-rate" class="form-input mt-1" value="10.50">
                        <p id="pgbl-rate-info" class="text-xs text-gray-500 mt-1 flex items-center">
                            <span class="loader mr-2"></span> Buscando taxa CDI atual...
                        </p>
                    </div>
                    <button onclick="calculatePension('pgbl')" class="w-full text-white font-bold py-3 px-4 rounded-lg calculate-btn">
                        Calcular Projeção
                    </button>
                    <div id="pgbl-results" class="result-card p-4 rounded-lg" style="display:none;"></div>
                </div>

                <!-- Calculadora VGBL -->
                <div class="bg-white p-6 rounded-xl shadow-lg space-y-4">
                    <h3 class="text-2xl font-semibold text-green-800">Calculadora VGBL</h3>
                    <div>
                        <label for="vgbl-initial" class="font-medium text-gray-700">Aporte Inicial (R$)</label>
                        <input type="number" id="vgbl-initial" class="form-input mt-1" placeholder="0">
                    </div>
                    <div>
                        <label for="vgbl-monthly" class="font-medium text-gray-700">Aporte Mensal (R$)</label>
                        <input type="number" id="vgbl-monthly" class="form-input mt-1" placeholder="500">
                    </div>
                    <div>
                        <label for="vgbl-years" class="font-medium text-gray-700">Tempo de Investimento (anos)</label>
                        <input type="number" id="vgbl-years" class="form-input mt-1" placeholder="30">
                    </div>
                    <div>
                        <label for="vgbl-rate" class="font-medium text-gray-700">Rentabilidade Anual (%)</label>
                        <input type="number" id="vgbl-rate" class="form-input mt-1" value="10.50">
                        <p id="vgbl-rate-info" class="text-xs text-gray-500 mt-1 flex items-center">
                            <span class="loader mr-2"></span> Buscando taxa CDI atual...
                        </p>
                    </div>
                    <button onclick="calculatePension('vgbl')" class="w-full text-white font-bold py-3 px-4 rounded-lg calculate-btn">
                        Calcular Projeção
                    </button>
                    <div id="vgbl-results" class="result-card-vgbl p-4 rounded-lg" style="display:none;"></div>
                </div>
            </div>
        </section>

    </main>

    <footer class="text-center p-6 mt-12 bg-gray-100 border-t">
        <p class="text-gray-600">&copy; 2024 Guia de Previdência Privada. Todos os direitos reservados.</p>
        <p class="text-xs text-gray-500 mt-1">As simulações são apenas exemplos e não constituem recomendação de investimento.</p>
    </footer>
    
    <div id="alert-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4" style="display: none;">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm w-full text-center">
            <h4 class="text-xl font-bold text-red-600 mb-2">Atenção</h4>
            <p id="alert-message" class="text-gray-700 mb-4">Mensagem de erro aqui.</p>
            <button onclick="closeModal()" class="bg-red-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-600 transition-colors">Fechar</button>
        </div>
    </div>

    <script>
        // Função para formatar valores em moeda brasileira (BRL)
        const formatCurrency = (value) => value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });

        function showAlert(message) {
            document.getElementById('alert-message').innerText = message;
            document.getElementById('alert-modal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('alert-modal').style.display = 'none';
        }

        // Função para buscar e atualizar a taxa CDI
        async function fetchCDIRate() {
            const defaultRate = 10.50;
            const pgblRateInput = document.getElementById('pgbl-rate');
            const vgblRateInput = document.getElementById('vgbl-rate');
            const pgblRateInfo = document.getElementById('pgbl-rate-info');
            const vgblRateInfo = document.getElementById('vgbl-rate-info');

            try {
                // API do Banco Central para obter o último valor da série histórica do CDI
                const response = await fetch('https://api.bcb.gov.br/dados/serie/bcdata.sgs.12/dados/ultimos/1?formato=json');
                if (!response.ok) throw new Error('Falha na resposta da rede');
                
                const data = await response.json();
                const dailyRate = parseFloat(data[0].valor);
                
                // Converte a taxa diária para anual (considerando 252 dias úteis)
                const annualRate = ((Math.pow(1 + (dailyRate / 100), 252)) - 1) * 100;
                
                const formattedRate = annualRate.toFixed(2);
                pgblRateInput.value = formattedRate;
                vgblRateInput.value = formattedRate;

                const rateDate = new Date(data[0].data.split('/').reverse().join('-')).toLocaleDateString('pt-BR');
                const infoText = `Taxa CDI de ${rateDate} (anualizada). Referência de mercado.`;
                pgblRateInfo.innerHTML = infoText;
                vgblRateInfo.innerHTML = infoText;

            } catch (error) {
                console.error("Erro ao buscar taxa CDI:", error);
                const errorText = `Não foi possível buscar a taxa CDI. Usando valor padrão de ${defaultRate.toFixed(2)}%.`;
                pgblRateInfo.innerHTML = errorText;
                vgblRateInfo.innerHTML = errorText;
            }
        }

        // Função principal para calcular a projeção da previdência
        function calculatePension(type) {
            const initial = parseFloat(document.getElementById(type + '-initial').value) || 0;
            const monthly = parseFloat(document.getElementById(type + '-monthly').value) || 0;
            const years = parseInt(document.getElementById(type + '-years').value) || 0;
            const rate = parseFloat(document.getElementById(type + '-rate').value) || 0;

            if (years <= 0 || rate < 0 || monthly < 0 || initial < 0) {
                showAlert("Por favor, insira valores válidos. O tempo deve ser maior que zero e os outros valores não podem ser negativos.");
                return;
            }

            const monthlyRate = Math.pow(1 + (rate / 100), 1 / 12) - 1;
            const totalMonths = years * 12;
            let futureValue = initial * Math.pow(1 + monthlyRate, totalMonths);
            
            if (monthly > 0 && monthlyRate > 0) {
                 futureValue += monthly * ((Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate);
            } else if (monthly > 0) {
                futureValue += monthly * totalMonths;
            }

            const totalInvested = initial + (monthly * totalMonths);
            const totalInterest = futureValue - totalInvested;

            // --- NOVO CÁLCULO: Renda Mensal Estimada ---
            const withdrawalYears = 20;
            const withdrawalAnnualRate = 0.05; // 5% a.a. de rendimento conservador durante o recebimento
            const withdrawalMonths = withdrawalYears * 12;
            const withdrawalMonthlyRate = Math.pow(1 + withdrawalAnnualRate, 1 / 12) - 1;
            
            let monthlyIncome = 0;
            if (futureValue > 0 && withdrawalMonthlyRate > 0) {
                monthlyIncome = futureValue * (withdrawalMonthlyRate * Math.pow(1 + withdrawalMonthlyRate, withdrawalMonths)) / (Math.pow(1 + withdrawalMonthlyRate, withdrawalMonths) - 1);
            } else if (futureValue > 0) {
                monthlyIncome = futureValue / withdrawalMonths;
            }
            // --- FIM DO NOVO CÁLCULO ---

            const resultsContainer = document.getElementById(type + '-results');
            
            // Gera o HTML do resultado de acordo com o tipo de plano (PGBL ou VGBL)
            if (type === 'pgbl') {
                resultsContainer.innerHTML = `
                    <div class="space-y-3">
                        <p class="flex justify-between items-center text-lg">
                            <span class="font-medium text-gray-700">Valor Final Bruto:</span>
                            <span class="font-bold text-blue-600">${formatCurrency(futureValue)}</span>
                        </p>
                        <div class="bg-blue-100 text-blue-800 p-3 rounded-md text-sm">
                            <strong>Atenção:</strong> No PGBL, o Imposto de Renda no resgate incidirá sobre o <strong>valor total acumulado</strong> (${formatCurrency(futureValue)}).
                        </div>
                        <hr class="border-blue-200">
                        <div class="mt-3 text-center">
                            <p class="font-semibold text-gray-700 text-lg">Projeção de Renda Mensal:</p>
                            <p class="font-bold text-2xl text-indigo-600 my-1">${formatCurrency(monthlyIncome)}</p>
                            <p class="text-xs text-gray-500">
                                *Estimativa de renda por ${withdrawalYears} anos, considerando um rendimento de ${withdrawalAnnualRate * 100}% a.a. sobre o saldo durante o período de recebimento.
                            </p>
                        </div>
                    </div>
                `;
            } else if (type === 'vgbl') {
                 resultsContainer.innerHTML = `
                    <div class="space-y-3">
                         <p class="flex justify-between items-center text-lg">
                            <span class="font-medium text-gray-700">Valor Final Bruto:</span>
                            <span class="font-bold text-green-600">${formatCurrency(futureValue)}</span>
                        </p>
                        <hr class="border-gray-200">
                        <p class="flex justify-between items-center text-md">
                            <span class="text-gray-600">Total Investido (Principal):</span>
                            <span class="font-semibold text-gray-800">${formatCurrency(totalInvested)}</span>
                        </p>
                        <p class="flex justify-between items-center text-md">
                            <span class="text-gray-600">Total em Rendimentos:</span>
                            <span class="font-semibold text-gray-800">${formatCurrency(totalInterest)}</span>
                        </p>
                         <div class="bg-green-100 text-green-800 p-3 rounded-md text-sm">
                            <strong>Vantagem:</strong> No VGBL, o Imposto de Renda no resgate incidirá <strong>apenas sobre os rendimentos</strong> (${formatCurrency(totalInterest)}).
                        </div>
                        <hr class="border-green-200">
                        <div class="mt-3 text-center">
                            <p class="font-semibold text-gray-700 text-lg">Projeção de Renda Mensal:</p>
                            <p class="font-bold text-2xl text-indigo-600 my-1">${formatCurrency(monthlyIncome)}</p>
                            <p class="text-xs text-gray-500">
                                *Estimativa de renda por ${withdrawalYears} anos, considerando um rendimento de ${withdrawalAnnualRate * 100}% a.a. sobre o saldo durante o período de recebimento.
                            </p>
                        </div>
                    </div>
                `;
            }
            
            resultsContainer.style.display = 'block';
        }

        // Ao carregar a página, busca a taxa CDI
        window.onload = fetchCDIRate;
    </script>
</body>
</html>
